{"primaryContentSections":[{"content":[{"anchor":"overview","level":2,"text":"Overview","type":"heading"},{"type":"paragraph","inlineContent":[{"type":"text","text":"If the simplified checkout flow with the "},{"type":"codeVoice","code":"\/sessions"},{"text":" endpoint does not work for you, or you prefer to have more control over the whole flow, please refer to ","type":"text"},{"identifier":"AdvancedFlow.md","isActive":true,"type":"reference"},{"type":"text","text":"."}]},{"type":"heading","level":2,"text":"Setting up the Drop-in","anchor":"Setting-up-the-Drop-in"},{"inlineContent":[{"text":"All Components need an ","type":"text"},{"type":"reference","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenContext","isActive":true},{"type":"text","text":". An instance of "},{"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenContext","type":"reference","isActive":true},{"text":" wraps your client key, environment, payment, analytics configuration and so on.","type":"text"},{"type":"text","text":" "},{"type":"text","text":"Please read more "},{"isActive":true,"type":"reference","identifier":"https:\/\/docs.adyen.com\/development-resources\/client-side-authentication"},{"type":"text","text":" about the client key and how to get one."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Use "},{"type":"codeVoice","code":"Environment.test"},{"type":"text","text":" during testing. When you’re ready to accept live payments, change the value to one of our "},{"overridingTitleInlineContent":[{"text":"live environments","type":"text"}],"type":"reference","isActive":true,"overridingTitle":"live environments","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/Environment"},{"text":".","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"We recommend creating a new context for each payment attempt.","type":"text"}]},{"code":["var context: AdyenContext {","    let apiContext = try! APIContext(environment: componentsEnvironment, clientKey: clientKey)","    return AdyenContext(apiContext: apiContext,","                        payment: payment,","                        analyticsConfiguration: analyticsConfiguration)","}"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"text","text":"Create an instance of "},{"type":"codeVoice","code":"AdyenSession.Configuration"},{"type":"text","text":" with the response you received from the "},{"type":"codeVoice","code":"\/sessions"},{"type":"text","text":" call and the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenContext"},{"type":"text","text":" instance."}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["let configuration = AdyenSession.Configuration(sessionIdentifier: response.sessionId,","                                               initialSessionData: response.sessionData,","                                               context: context)"]},{"inlineContent":[{"type":"text","text":"Call the static "},{"code":"initialize","type":"codeVoice"},{"text":" function of the ","type":"text"},{"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenSession","isActive":true,"type":"reference"},{"text":" by providing the configuration and the delegates, which will asynchronously create and return the session instance.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["AdyenSession.initialize(with: configuration, delegate: self, presentationDelegate: self) { [weak self] result in","    switch result {","    case let .success(session):","        \/\/ store the session object","        self?.session = session","    case let .failure(error):","        \/\/ handle the error","    }","}"],"type":"codeListing"},{"inlineContent":[{"text":"Create a configuration object for ","type":"text"},{"type":"reference","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/DropInComponent","isActive":true},{"text":". Check specific payment method pages to confirm if you need to include additional required parameters.","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["\/\/ Check specific payment method pages to confirm if you need to configure additional required parameters.","let dropInConfiguration = DropInComponent.Configuration()","let component = DropInComponent(paymentMethods: paymentMethods,","                                context: context,","                                configuration: dropInConfiguration)",""],"syntax":"swift"},{"inlineContent":[{"text":"Some payment methods need additional configuration. For example ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/ApplePayComponent"},{"text":". These payment method specific configuration parameters can be set in an instance of ","type":"text"},{"type":"codeVoice","code":"DropInComponent.Configuration"},{"text":":","type":"text"}],"type":"paragraph"},{"code":["let summaryItems = [","                      PKPaymentSummaryItem(label: \"Item A\", amount: 75, type: .final),","                      PKPaymentSummaryItem(label: \"Item B\", amount: 25, type: .final),","                      PKPaymentSummaryItem(label: \"My Company\", amount: 100, type: .final)","                   ]","let applePayment = try ApplePayPayment(countryCode: \"US\",","                                       currencyCode: \"USD\",","                                       summaryItems: summaryItems)","","let dropInConfiguration = DropInComponent.Configuration()","dropInConfiguration.applePay = .init(payment: applePayment,","                               merchantIdentifier: \"merchant.com.adyen.MY_MERCHANT_ID\")"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"text":"Also for voucher payment methods like Doku variants, in order for the ","type":"text"},{"type":"reference","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/DokuComponent","isActive":true},{"type":"text","text":" to enable the shopper to save the voucher, access to the shopper photos is requested, so a suitable text needs to be added to the "},{"code":"NSPhotoLibraryAddUsageDescription","type":"codeVoice"},{"text":" key in the application ","type":"text"},{"type":"codeVoice","code":"Info.plist"},{"type":"text","text":"."}],"type":"paragraph"},{"type":"heading","text":"Presenting the Drop-in","level":2,"anchor":"Presenting-the-Drop-in"},{"inlineContent":[{"type":"text","text":"Initialize the "},{"type":"reference","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/DropInComponent","isActive":true},{"text":" class and set the ","type":"text"},{"type":"reference","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenSession","isActive":true},{"type":"text","text":" instance as the "},{"code":"delegate","type":"codeVoice"},{"type":"text","text":" and "},{"type":"codeVoice","code":"partialPaymentDelegate"},{"type":"text","text":" (if needed) of the "},{"isActive":true,"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/DropInComponent","type":"reference"},{"type":"text","text":" instance."}],"type":"paragraph"},{"syntax":"swift","code":["let dropInComponent = DropInComponent(paymentMethods: paymentMethods,","                                      context: context,","                                      configuration: dropInConfiguration)"," ","\/\/ Keep the Drop-in instance to avoid it being destroyed after the function is executed.","self.dropInComponent = dropInComponent"," ","\/\/ Set session as the delegate for Drop-in","dropInComponent.delegate = session","dropInComponent.partialPaymentDelegate = session"," ","present(dropInComponent.viewController, animated: true)",""],"type":"codeListing"},{"text":"Implementing `AdyenSessionDelegate`","type":"heading","level":3,"anchor":"Implementing-AdyenSessionDelegate"},{"inlineContent":[{"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenSession","isActive":true,"type":"reference"},{"text":" makes the necessary calls to handle the whole flow and notifies your application through its delegate, ","type":"text"},{"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenSessionDelegate","type":"reference","isActive":true},{"text":". To handle the results of the Drop-in, the following methods of ","type":"text"},{"type":"reference","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenSessionDelegate","isActive":true},{"type":"text","text":" should be implemented:"}],"type":"paragraph"},{"type":"thematicBreak"},{"code":["func didComplete(with result: AdyenSessionResult, component: Component, session: AdyenSession)"],"type":"codeListing","syntax":"swift"},{"inlineContent":[{"type":"text","text":"This method will be invoked when the component finishes without any further steps needed by the application. The application just needs to dismiss the current component, ideally after calling "},{"type":"codeVoice","code":"finalizeIfNeeded"},{"text":" on the component.","type":"text"}],"type":"paragraph"},{"type":"thematicBreak"},{"type":"codeListing","code":["func didFail(with error: Error, from component: Component, session: AdyenSession)"],"syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"This method is invoked when an error occurred during the use of the Drop-in or the components.","type":"text"},{"text":" ","type":"text"},{"text":"You can then call the ","type":"text"},{"type":"codeVoice","code":"finalizeIfNeeded"},{"text":" on the component, dismiss the component’s view controller in the completion callback and display an error message.","type":"text"}]},{"type":"thematicBreak"},{"type":"codeListing","syntax":"swift","code":["func didOpenExternalApplication(component: DropInComponent)"]},{"inlineContent":[{"type":"text","text":"This optional method is invoked after a redirect to an external application has occurred."}],"type":"paragraph"},{"type":"thematicBreak"},{"text":"Handling an action","type":"heading","anchor":"Handling-an-action","level":2},{"inlineContent":[{"type":"text","text":"Actions are handled by the Drop-in via its delegate "},{"type":"reference","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenSession","isActive":true},{"type":"text","text":"."}],"type":"paragraph"},{"anchor":"Receiving-redirect","type":"heading","text":"Receiving redirect","level":3},{"inlineContent":[{"text":"In case the customer is redirected to an external URL or App, make sure to let the ","type":"text"},{"type":"reference","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/RedirectComponent","isActive":true},{"text":" know when the user returns to your app. Do this by implementing the following in your ","type":"text"},{"type":"codeVoice","code":"UIApplicationDelegate"},{"text":":","type":"text"}],"type":"paragraph"},{"code":["func application(_ app: UIApplication, open url: URL, options: [UIApplicationOpenURLOptionsKey: Any] = [:]) -> Bool {","    RedirectComponent.applicationDidOpen(from: url)","    return true","}"],"syntax":"swift","type":"codeListing"}],"kind":"content"}],"sections":[],"hierarchy":{"paths":[["doc:\/\/adyen.Adyen\/documentation\/Adyen"]]},"kind":"article","schemaVersion":{"patch":0,"minor":3,"major":0},"metadata":{"modules":[{"name":"Adyen"}],"role":"article","title":"DropIn","roleHeading":"Article"},"identifier":{"url":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/DropIn","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"The Drop-in handles the presentation of available payment methods and the subsequent entry of a customer’s payment details. It is initialized with the payment methods of the "},{"type":"codeVoice","code":"\/sessions"},{"type":"text","text":" response, and handles the entire checkout flow under the hood for most of use cases."}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/adyen\/dropin"]}],"references":{"doc://adyen.Adyen/documentation/Adyen/DropInComponent":{"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/DropInComponent","abstract":[{"text":"A component that handles the entire flow of payment selection and payment details entry.","type":"text"}],"role":"symbol","kind":"symbol","type":"topic","title":"DropInComponent","url":"\/documentation\/adyen\/dropincomponent","fragments":[{"text":"class","kind":"keyword"},{"kind":"text","text":" "},{"text":"DropInComponent","kind":"identifier"}],"navigatorTitle":[{"kind":"identifier","text":"DropInComponent"}]},"doc://adyen.Adyen/documentation/Adyen/DokuComponent":{"abstract":[{"type":"text","text":"A component that provides a form for Doku Wallet, Doku Alfamart, and Doku Indomaret  payments."}],"type":"topic","navigatorTitle":[{"kind":"identifier","text":"DokuComponent"}],"url":"\/documentation\/adyen\/dokucomponent","kind":"symbol","fragments":[{"text":"class","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"DokuComponent"}],"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/DokuComponent","role":"symbol","title":"DokuComponent"},"doc://adyen.Adyen/documentation/Adyen/RedirectComponent":{"fragments":[{"kind":"keyword","text":"class"},{"text":" ","kind":"text"},{"kind":"identifier","text":"RedirectComponent"}],"url":"\/documentation\/adyen\/redirectcomponent","role":"symbol","title":"RedirectComponent","abstract":[{"text":"Handles any redirect Url whether its a web url, an App custom scheme url, or an app universal link.","type":"text"}],"navigatorTitle":[{"kind":"identifier","text":"RedirectComponent"}],"type":"topic","kind":"symbol","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/RedirectComponent"},"doc://adyen.Adyen/documentation/Adyen/ApplePayComponent":{"role":"symbol","abstract":[{"type":"text","text":"A component that handles Apple Pay payments."}],"title":"ApplePayComponent","fragments":[{"kind":"keyword","text":"class"},{"text":" ","kind":"text"},{"kind":"identifier","text":"ApplePayComponent"}],"navigatorTitle":[{"text":"ApplePayComponent","kind":"identifier"}],"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/ApplePayComponent","kind":"symbol","type":"topic","url":"\/documentation\/adyen\/applepaycomponent"},"doc://adyen.Adyen/documentation/Adyen/AdyenContext":{"type":"topic","url":"\/documentation\/adyen\/adyencontext","navigatorTitle":[{"kind":"identifier","text":"AdyenContext"}],"role":"symbol","title":"AdyenContext","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenContext","abstract":[{"type":"text","text":"A class that defines the behavior of the components in a payment flow."}],"kind":"symbol","fragments":[{"kind":"keyword","text":"class"},{"text":" ","kind":"text"},{"kind":"identifier","text":"AdyenContext"}]},"doc://adyen.Adyen/documentation/Adyen/AdyenSession":{"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenSession","kind":"symbol","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"AdyenSession","kind":"identifier"}],"title":"AdyenSession","navigatorTitle":[{"text":"AdyenSession","kind":"identifier"}],"url":"\/documentation\/adyen\/adyensession","role":"symbol","abstract":[{"isActive":true,"type":"reference","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenSession"},{"text":" acts as the delegate for the checkout payment flow.","type":"text"},{"text":" ","type":"text"},{"text":"It can handle the required steps internally such as ","type":"text"},{"type":"codeVoice","code":"\/payments"},{"type":"text","text":" and "},{"code":"\/payment\/details","type":"codeVoice"},{"type":"text","text":" "},{"type":"text","text":"calls and partial payment calls, then provide feedback"},{"text":" ","type":"text"},{"type":"text","text":"via "},{"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenSessionDelegate","isActive":true,"type":"reference"},{"type":"text","text":" methods."}],"type":"topic"},"doc://adyen.Adyen/documentation/Adyen":{"url":"\/documentation\/adyen","type":"topic","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen","title":"Adyen","role":"collection","abstract":[],"kind":"symbol"},"https://docs.adyen.com/development-resources/client-side-authentication":{"titleInlineContent":[{"text":"here","type":"text"}],"type":"link","title":"here","url":"https:\/\/docs.adyen.com\/development-resources\/client-side-authentication","identifier":"https:\/\/docs.adyen.com\/development-resources\/client-side-authentication"},"doc://adyen.Adyen/documentation/Adyen/Environment":{"url":"\/documentation\/adyen\/environment","kind":"symbol","abstract":[{"type":"text","text":"Struct that defines the environment to retrieve resources from."}],"role":"symbol","identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/Environment","type":"topic","title":"Environment","fragments":[{"text":"struct","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"Environment"}],"navigatorTitle":[{"kind":"identifier","text":"Environment"}]},"AdvancedFlow.md":{"titleInlineContent":[{"type":"text","text":"Advanced Flow"}],"type":"link","title":"Advanced Flow","url":"AdvancedFlow.md","identifier":"AdvancedFlow.md"},"doc://adyen.Adyen/documentation/Adyen/AdyenSessionDelegate":{"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenSessionDelegate","role":"symbol","type":"topic","abstract":[{"text":"Describes the methods a delegate of ","type":"text"},{"identifier":"doc:\/\/adyen.Adyen\/documentation\/Adyen\/AdyenSession","isActive":true,"type":"reference"},{"text":" needs to implement.","type":"text"}],"url":"\/documentation\/adyen\/adyensessiondelegate","navigatorTitle":[{"text":"AdyenSessionDelegate","kind":"identifier"}],"fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"AdyenSessionDelegate","kind":"identifier"}],"kind":"symbol","title":"AdyenSessionDelegate"}}}